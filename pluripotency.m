%% 无BRD 稳态
x1 = [3.08400000000000,1.09900000000000,1.09940000000000,1.09530000000000,6.28470000000000,1.14220000000000,1.09940000000000,1.00720000000000,5.12540000000000,3.12370000000000,3.03360000000000,0.164300000000000,1.13710000000000,0];
x2 = [3.15950000000000,1.09900000000000,1.09920000000000,1.09570000000000,5.49760000000000,1.14280000000000,1.09920000000000,1.44000000000000,5.12590000000000,3.12410000000000,3.03380000000000,0.164000000000000,1.13660000000000,0.432900000000000];
x3 = [3.18550000000000,1.09900000000000,1.09850000000000,1.09580000000000,4.52740000000000,1.14440000000000,1.09850000000000,1.97320000000000,5.12620000000000,3.12460000000000,3.03410000000000,0.164400000000000,1.13630000000000,0.966100000000000];

e=0.03;
a=1.1;
b=2;
k=1;
n=3;
s=0.5;
d1 = [e,e,e,e,e,e,e,e,e,e/(k-b*s^n*(n*x1(10)^(n-1)/(s^n+x1(10)^n)^2)),e/(k-b*s^n*(n*x1(11)^(n-1)/(s^n+x1(11)^n)^2)),e, e, e/(k-a*(n*x1(14)^(n-1)*(s^n+x1(14)^n)-n*x1(14)^n*x1(14)^(n-1))/(s^n+x1(14)^n)^2)];
d2 = [e,e,e,e,e,e,e,e,e,e/(k-b*s^n*(n*x2(10)^(n-1)/(s^n+x2(10)^n)^2)),e/(k-b*s^n*(n*x2(11)^(n-1)/(s^n+x2(11)^n)^2)),e, e, e/(k-a*(n*x2(14)^(n-1)*(s^n+x2(14)^n)-n*x2(14)^n*x2(14)^(n-1))/(s^n+x2(14)^n)^2)];
d3 = [e,e,e,e,e,e,e,e,e,e/(k-b*s^n*(n*x3(10)^(n-1)/(s^n+x3(10)^n)^2)),e/(k-b*s^n*(n*x3(11)^(n-1)/(s^n+x3(11)^n)^2)),e, e, e/(k-a*(n*x3(14)^(n-1)*(s^n+x3(14)^n)-n*x3(14)^n*x3(14)^(n-1))/(s^n+x3(14)^n)^2)];

%% BRD 稳态
x4 = [3.08400000000000,1.09900000000000,1.09940000000000,1.09530000000000,6.28470000000000,1.14220000000000,1.09940000000000,1.00720000000000,5.12540000000000,3.12370000000000,3.03360000000000,0.164300000000000,1.13710000000000,0];
x5 = [3.15970000000000,1.09900000000000,1.09920000000000,1.09570000000000,5.49430000000000,1.14280000000000,1.09920000000000,1.44180000000000,5.12590000000000,3.12410000000000,3.03380000000000,0.164000000000000,1.13660000000000,0.433900000000000];
x6 = [3.18550000000000,1.09900000000000,1.09850000000000,1.09580000000000,4.52530000000000,1.14440000000000,1.09850000000000,1.97440000000000,5.12620000000000,3.12460000000000,3.03410000000000,0.164400000000000,1.13630000000000,0.969300000000000];

d4 =[0.0300000000000000,0.0300000000000000,0.0300000000000000,0.0300000000000000,0.0301000000000000,0.0300000000000000,0.0300000000000000,0.0300000000000000,0.0300000000000000,0.0302000000000000,0.0303000000000000,0.0300000000000000,0.0300000000000000,0.0300000000000000];
d5 = [0.0300000000000000,0.0300000000000000,0.0300000000000000,0.0300000000000000,0.0300000000000000,0.0300000000000000,0.00330000000000000,0.0300000000000000,0.0300000000000000,0.0302000000000000,0.0303000000000000,0.0300000000000000,0.0300000000000000,0.0300000000000000];
d6 = [0.0300000000000000,0.0300000000000000,0.0300000000000000,0.0300000000000000,0.0300000000000000,0.0300000000000000,0.0349000000000000,0.0300000000000000,0.0300000000000000,0.0302000000000000,0.0303000000000000,0.0300000000000000,0.0300000000000000,0.0300000000000000];

%% V图谱
[X,Y]=meshgrid(0:0.1:3, 3:0.1:8);
Z1 =  -log(0.6153*(1/sqrt(2*pi*d1(8))*exp(-(X-x1(8)).^2/(2*d1(8)))).*(1/sqrt(2*pi*d1(5))*exp(-(Y-x1(5)).^2/(2*d1(5)))) + 0.0779*(1/sqrt(2*pi*d2(8))*exp(-(X-x2(8)).^2/(2*d2(8)))).*(1/sqrt(2*pi*d2(5))*exp(-(Y-x2(5)).^2/(2*d2(5)))) + 0.3066*(1/sqrt(2*pi*d3(8))*exp(-(X-x3(8)).^2/(2*d3(8)))).*(1/sqrt(2*pi*d3(5))*exp(-(Y-x3(5)).^2/(2*d3(5)))));
Z0 =  -log(1+ 0.6153*(1/sqrt(2*pi*d1(8))*exp(-(X-x1(8)).^2/(2*d1(8)))).*(1/sqrt(2*pi*d1(5))*exp(-(Y-x1(5)).^2/(2*d1(5)))) + 0.0779*(1/sqrt(2*pi*d2(8))*exp(-(X-x2(8)).^2/(2*d2(8)))).*(1/sqrt(2*pi*d2(5))*exp(-(Y-x2(5)).^2/(2*d2(5)))) + 0.3066*(1/sqrt(2*pi*d3(8))*exp(-(X-x3(8)).^2/(2*d3(8)))).*(1/sqrt(2*pi*d3(5))*exp(-(Y-x3(5)).^2/(2*d3(5)))));
% Z2 =  -log(0.5755*(1/sqrt(2*pi*d4(8))*exp(-(X-x4(8)).^2/(2*d4(8)))).*(1/sqrt(2*pi*d4(5))*exp(-(Y-x4(5)).^2/(2*d4(5)))) + 0.0632*(1/sqrt(2*pi*d5(8))*exp(-(X-x5(8)).^2/(2*d5(8)))).*(1/sqrt(2*pi*d5(5))*exp(-(Y-x5(5)).^2/(2*d5(5)))) + 0.3612*(1/sqrt(2*pi*d6(8))*exp(-(X-x6(8)).^2/(2*d6(8)))).*(1/sqrt(2*pi*d6(5))*exp(-(Y-x6(5)).^2/(2*d6(5)))));
Z2 = -log(0.4015*(1/sqrt(2*pi*d1(8))*exp(-(X-x1(8)).^2/(2*d1(8)))).*(1/sqrt(2*pi*d1(5))*exp(-(Y-x1(5)).^2/(2*d1(5)))) + 0.0774*(1/sqrt(2*pi*d2(8))*exp(-(X-x2(8)).^2/(2*d2(8)))).*(1/sqrt(2*pi*d2(5))*exp(-(Y-x2(5)).^2/(2*d2(5)))) + 0.521*(1/sqrt(2*pi*d3(8))*exp(-(X-x3(8)).^2/(2*d3(8)))).*(1/sqrt(2*pi*d3(5))*exp(-(Y-x3(5)).^2/(2*d3(5)))));
Z = Z1-Z2;

% 绘制潜势图谱
figure;
surfc(X, Y, Z);
hold on;
scatter3(x1(8), x1(5),-0.426902420359625, 100, 'MarkerEdgeColor',[0 .5 .5], 'MarkerFaceColor','k');
hold on;
scatter3(x2(8), x2(5),-0.006439746977691, 100, 'MarkerEdgeColor',[0 .6 .6], 'MarkerFaceColor','k');
hold on;
scatter3(x3(8), x3(5),0.530206075315647, 100, 'MarkerEdgeColor',[0 .7 .7], 'MarkerFaceColor','k');
xlabel('CHEK1');
ylabel('P53');



%% 绘制等高线图
figure;
contourf(X, Y, Z, 5);
hold on;
scatter(x1(8), x1(5), 100, 'MarkerEdgeColor',[0 .5 .5], 'MarkerFaceColor','r');
hold on;
scatter(x2(8), x2(5), 100, 'MarkerEdgeColor',[0 .6 .6], 'MarkerFaceColor','g');
hold on;
scatter(x3(8), x3(5), 100, 'MarkerEdgeColor',[0 .7 .7], 'MarkerFaceColor','b');
hold on;

vertices = [2.09610945745910,2,1.90000000000000,1.85424639310745,1.80000000000000,1.70000000000000,1.60776649648111,1.60000000000000,1.50000000000000,1.49516842924028,1.41191186023602,1.40000000000000,1.35649380390473,1.32490689600531,1.31599275948493,1.31835463945444,1.33461276017114,1.38217669851717,1.40000000000000,1.40194542504546,1.40000000000000,1.30000000000000,1.20000000000000,1.15113109748833,1.10000000000000,1.01925710851787,1,0.934801155541044,0.901597200455951,0.900000000000000,0.859314148746271,0.845751434629639,0.827562922838718,0.800000000000000,0.700000000000000,0.668011318261220,0.600000000000000,0.527664018396188,0.500000000000000,0.436976395686492,0.400000000000000,0.397993067721465,0.338023058030910,0.319730751068124,0.316203233656117,0.323197781674981,0.349462353254393,0.400000000000000,0.406193963975808,0.464892040487186,0.500000000000000,0.564577706940749,0.600000000000000,0.700000000000000,0.732909456462341,0.800000000000000,0.900000000000000,1,1.10000000000000,1.20000000000000,1.27974173594017,1.30000000000000,1.40000000000000,1.45227468891528,1.50000000000000,1.55337199636759,1.60000000000000,1.60000000000003,1.66646277246979,1.68629009979088,1.69160848260707,1.68945086559864,1.68304701552352,1.70000000000000,1.73222018420470,1.80000000000000,1.85980752076285,1.90000000000000,1.94001162203375,1.98683326545417,2,2.00513120402143,2.02274617741634,2.00716990808662,2,1.98942630602442,1.98097915561640,2,2.10000000000000,2.20000000000000,2.26485945361721,2.30000000000000,2.40000000000000,2.40715964737049,2.49666495395582,2.50000000000000,2.57194166576335,2.59561249260112,2.60000000000000,2.61851531559254,2.62527146537037,2.60000000000000,2.59997788155227,2.58611594152067,2.53900837507808,2.50000000000000,2.46546371730647,2.40000000000000,2.34620149241047,2.30000000000000,2.20000000000000,2.10000000000000,2.09610945745910;3.90000000000000,3.87577662915638,3.88280131479451,3.90000000000000,3.90472418394430,3.92881083976050,4,4.00385273486922,4.09499335350114,4.10000000000000,4.20000000000000,4.23689874446545,4.30000000000000,4.40000000000000,4.50000000000000,4.60000000000000,4.70000000000000,4.80000000000000,4.88369332275121,4.90000000000000,4.90123972678489,4.92323379428242,4.96377408394794,5,5.02422184436094,5.10000000000000,5.12351142170099,5.20000000000000,5.30000000000000,5.31027202429083,5.40000000000000,5.50000000000000,5.60000000000000,5.61669585338562,5.67415747495324,5.70000000000000,5.73195129832038,5.80000000000000,5.83048183869495,5.90000000000000,5.99734818805794,6,6.10000000000000,6.20000000000000,6.30000000000000,6.40000000000000,6.50000000000000,6.57650157435951,6.60000000000000,6.70000000000000,6.73760337696478,6.80000000000000,6.83266676842901,6.89197961475306,6.90000000000000,6.94332319320734,6.97139569735412,6.97847408036956,6.97330648747747,6.94962266016063,6.90000000000000,6.89546259628882,6.84754644431066,6.80000000000000,6.75664608608514,6.70000000000000,6.60000000000004,6.60000000000000,6.50000000000000,6.40000000000000,6.30000000000000,6.20000000000000,6.10000000000000,6.03710136912035,6,5.95777110490617,5.90000000000000,5.84734005005073,5.80000000000000,5.70000000000000,5.61120118642450,5.60000000000000,5.50000000000000,5.40000000000000,5.38220825823767,5.30000000000000,5.20000000000000,5.19249871182765,5.17687454194564,5.14479334655988,5.10000000000000,5.08865358552378,5.00690870121911,5,4.90000000000000,4.89327373426607,4.80000000000000,4.70000000000000,4.64944009475821,4.60000000000000,4.50000000000000,4.40043664699412,4.40000000000000,4.30000000000000,4.20000000000000,4.15346205928389,4.10000000000000,4.03456984853665,4,3.96131767552236,3.91410012566502,3.90019488108157,3.90000000000000];
vertices = vertices';
plot(vertices(:,1), vertices(:,2), 'LineWidth', 2)



% syms x y 
% p= -log(0.6153*(1/sqrt(2*pi*d1(8))*exp(-(x-x1(8)).^2/(2*d1(8)))).*(1/sqrt(2*pi*d1(5))*exp(-(y-x1(5)).^2/(2*d1(5)))) + 0.0779*(1/sqrt(2*pi*d2(8))*exp(-(x-x2(8)).^2/(2*d2(8)))).*(1/sqrt(2*pi*d2(5))*exp(-(y-x2(5)).^2/(2*d2(5)))) + 0.3066*(1/sqrt(2*pi*d3(8))*exp(-(x-x3(8)).^2/(2*d3(8)))).*(1/sqrt(2*pi*d3(5))*exp(-(y-x3(5)).^2/(2*d3(5)))))+log(0.4885*(1/sqrt(2*pi*d4(8))*exp(-(x-x4(8)).^2/(2*d4(8)))).*(1/sqrt(2*pi*d4(5))*exp(-(y-x4(5)).^2/(2*d4(5)))) + 0.0699*(1/sqrt(2*pi*d5(8))*exp(-(x-x5(8)).^2/(2*d5(8)))).*(1/sqrt(2*pi*d5(5))*exp(-(y-x5(5)).^2/(2*d5(5)))) + 0.4411*(1/sqrt(2*pi*d6(8))*exp(-(x-x6(8)).^2/(2*d6(8)))).*(1/sqrt(2*pi*d6(5))*exp(-(y-x6(5)).^2/(2*d6(5)))));
% Dx=-e*diff(p,x);
% Dy=-e*diff(p,y);
% % 选择绘制区域
% xRange = linspace(0, 3, 20);
% yRange = linspace(3, 8, 20);
% [X, Y] = meshgrid(xRange, yRange);
% 
% % 计算在网格点上的probability flux
% DX = subs(Dx, {x, y}, {X, Y});
% DY = subs(Dy, {x, y}, {X, Y});
% quiver(X, Y, double(DX), double(DY), 'r'); % 'r' 表示红色箭头

xlabel('CHEK1');
ylabel('P53');
colorbar;
